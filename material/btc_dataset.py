# -*- coding: utf-8 -*-
"""BTC_dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_nNZQhH2k1SOgHP4BCAolfS4p6pZ2WQQ
"""

!pip install yfinance

# imports
import requests
import pandas as pd
import numpy as np
import yfinance as yf

r = requests.get('http://api.alternative.me/fng/?limit=0')

df = pd.DataFrame(r.json()['data'])

df.value = df.value.astype(int)

df.timestamp = pd.to_datetime(df.timestamp,unit = 's')

df.set_index('timestamp',inplace = True)

df = df[::-1]

df

df_btc = yf.download('BTC-USD')

df_btc.index.name = 'timestamp'

df_btc

merged = df.merge(df_btc,on = 'timestamp')

merged

merged = merged.drop(['value_classification', 'time_until_update'], axis = 1)

merged = merged[['Open','High','Low','Close','Adj Close','Volume','value']]

merged

